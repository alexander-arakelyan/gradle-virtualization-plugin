buildscript {
    repositories {
        flatDir {
            dirs "../gradle-virtualization-plugin/build/libs"
        }
    }
    dependencies {
        def pluginExists = file("../gradle-virtualization-plugin/build/libs/gradle-virtualization-plugin-${version}.jar").exists()
        if (pluginExists) {
            logger.lifecycle("Plugin JAR found - classpath")
            classpath name: "gradle-virtualization-plugin", version: "${version}", classifier: ""
        } else {
            logger.lifecycle("No plugin JAR found")
        }
    }
}

apply plugin: "java"
def pluginExists = file("../gradle-virtualization-plugin/build/libs/gradle-virtualization-plugin-${version}.jar").exists()
//pluginExists=false
if (pluginExists) {
    apply plugin: "${project.group}.virtualization.plugin"
}

if (pluginExists) {
    logger.lifecycle("Plugin JAR found - config")
    kubernetes {

    }

    docker {
        dockerFile = "src/main/docker/Dockerfile"
        dockerCommand = "docker"
        repo = "${dockerRepo}"
        repoNamespace = "${dockerNamespace}"
        username = "${dockerUsername}"
        password = "${dockerPassword}"
        dockerBuildDir = buildDir
    }
} else {
    logger.lifecycle("No plugin JAR found")
}
