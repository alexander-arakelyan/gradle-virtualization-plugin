buildscript {
    repositories {
        flatDir {
            dirs "../gradle-virtualization-plugin/build/libs"
        }
    }
    dependencies {
        def pluginExists = file("../gradle-virtualization-plugin/build/libs/gradle-virtualization-plugin-1.0-SNAPSHOT.jar").exists()
        if (pluginExists) {
            logger.lifecycle("Plugin JAR found - classpath")
            classpath name: "gradle-virtualization-plugin", version: "1.0-SNAPSHOT", classifier: ""
        } else {
            logger.lifecycle("No plugin JAR found")
        }
    }
}

apply plugin: "java"
def pluginExists = file("../gradle-virtualization-plugin/build/libs/gradle-virtualization-plugin-1.0-SNAPSHOT.jar").exists()
if (pluginExists) {
    apply plugin: "org.bambrikii.gradle.virtualization.plugin"
}

if (pluginExists) {
    logger.lifecycle("Plugin JAR found - config")
    kubernetes {

    }

    docker {
        dockerFile = "src/main/docker/Dockerfile"
        dockerCommand = "docker"
        dockerRepo = "docker.io"
        username = "zzz"
        password = "zzz"
        dockerBuildDir = buildDir
    }
} else {
    logger.lifecycle("No plugin JAR found")
}
